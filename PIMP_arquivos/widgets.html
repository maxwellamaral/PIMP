<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title>PIMP</title>
<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5"/>
<link href="visio.css" rel="stylesheet">
<script src="keys.js" type="text/javascript" language="javascript"></script>
<script src="find.js" type="text/javascript" language="javascript"></script>
<script type="text/javascript" language="javascript">
	
	var imgMin = new Image();
	imgMin.src = "minimize.gif";
	
	var imgMax = new Image();
	imgMax.src = "maximize.gif";

	var fileList = parent.g_FileList;
	
	function Widgets()
	{
		this.GoTo = null;
		this.Search = null;
		this.Details = null;
		this.PNZ = null;

		this.divCount = 0;
		
		this.OpenText = "Recolher tudo";
		this.OpenAlt = "Recolher tudo";
		this.ClosedText = "Expandir tudo";
		this.ClosedAlt = "Expandir tudo";

		this.Display = "";
		this.Img = imgMin;
		this.Text = this.OpenText;
		this.Alt = this.OpenAlt;
		
		this.ToggleAll = ToggleAll;
		this.ToggleWidget = ToggleWidget;
		this.Add = Add;
	}		

	function Add(div, name)
	{
		tmpStr = "this." + name + " = new Widget(div);"
		eval(tmpStr);
		var thisWidget = eval("this." + name);
	}

	function Widget(div)
	{
		return div;
	}	

	function ToggleAll()
	{
		var OpenCloseFunc = Widget;

		if(this.Display == "")
		{
			this.Display = "none";
			this.Img = imgMax;
			this.Text = this.ClosedText;
			this.Alt = this.ClosedAlt;
			document.getElementById("expparent00").title = this.ClosedAlt;
			OpenCloseFunc = CloseWidget;
		}
		else
		{
			this.Display = "";
			this.Img = imgMin;
			this.Text = this.OpenText;
			this.Alt = this.OpenAlt;
			document.getElementById("expparent00").title = this.OpenAlt;
			OpenCloseFunc = OpenWidget;
		}
		document.getElementById("exp00").src = this.Img.src;	
		document.getElementById("textExp").innerHTML = this.Text;
		document.getElementById("exp00").alt = this.Alt;
	
		if(this.GoTo)
		{
			OpenCloseFunc(this.GoTo)
		}
		if(this.Search)
		{
			OpenCloseFunc(this.Search)
		}
		if(this.Details)
		{
			OpenCloseFunc(this.Details)
		}
		if(this.PNZ)
		{
			OpenCloseFunc(this.PNZ)
		}
	}

	function ToggleNav()
	{
		if(document.getElementById("divCollapsedNav").style.display == "none")
		{
			document.getElementById("divCollapsedNav").style.display = "";
			document.getElementById("divOpenNav").style.display = "none";
			parent.document.getElementById("frmstOuter").cols = "20,*"
			parent.document.getElementById("frmToolbar").noResize = true;
		}
		else
		{
			document.getElementById("divOpenNav").style.display = "";
			document.getElementById("divCollapsedNav").style.display = "none";
			parent.document.getElementById("frmstOuter").cols = "237,*"
			parent.document.getElementById("frmToolbar").noResize = false;
		}
	}
	
	function ToggleWidget(div)
	{
		if(div.style.display == "none")
		{
			OpenWidget(div);
		}
		else
		{
			CloseWidget(div);
		}
	}

	function OpenWidget(div)
	{
		document.getElementById(div.img).src = imgMin.src;
		div.style.display = "";
		document.getElementById(div.img).alt = div.openAlt;
		document.getElementById(div.img + "1").title = div.openAlt;
		document.getElementById(div.img + "2").title = div.openAlt;
	}

	function CloseWidget(div)
	{
		document.getElementById(div.img).src = imgMax.src;
		div.style.display = "none";
		document.getElementById(div.img).alt = div.closedAlt;
		document.getElementById(div.img + "1").title = div.closedAlt;
		document.getElementById(div.img + "2").title = div.closedAlt;
	}

	function load()
	{
		parent.g_WidgetsLoaded = true;

		if (parent.g_LoadingWidgets)
		{
			parent.g_LoadingWidgets = false;
			parent.location.reload();
		}
	}

	function unload()
	{
		parent.g_LoadingWidgets = true;
	}
	
		
	var widgets = new Widgets();

</script>

</head>
<body onload="load();" onunload="unload();" onkeypress="keyHandler(event)">
<div id="divOpenNav" class="nav">

	<table id="tabToc" width="100%" class="navTocColor" style="margin-bottom:1px;" cellspacing="0" cellpadding="0" border="0" height="20" dir=ltr>
	<tr>
	<td width="2"><a href="javascript:ToggleNav();" title="Recolher quadro de navegação" id="linkNavOpen"><img src="toc.gif" alt="Recolher quadro de navegação" width="22" height="17" border="0"></a></td>
	<td><p class="p1"><a href="javascript:ToggleNav();" title="Recolher quadro de navegação" class="a1">Ocultar</a></p></td>
	<td align="right"><p class="p1"><a href="javascript:widgets.ToggleAll()" id="textExp" class="a1">Recolher tudo</a></p></td>
	<td width="2">
		<div style="padding:2pt,1.5pt,0pt,0pt"><a href="javascript:widgets.ToggleAll()" title="Recolher tudo" id="expparent00"><img id="exp00" alt="Recolher tudo" src="minimize.gif" width="15" height="15" border="0"></a></div>
	</td>
	</tr>
	</table>
	
	

	

	

	


</div>

<div id="divCollapsedNav" class="navTocColor" style="display:none;width:100%;height:100%;">
	<a href="javascript:ToggleNav();" title="Expandir quadro de navegação" id="linkNavClosed"><img src="toc2.gif" alt="Expandir quadro de navegação" border="0"></a>
</div>	


</body>
</html>

